<div class="dashboard-container">
  <div class="dashboard-header">
    <h2><i class="fas fa-chart-line"></i> Bienvenue sur votre Tableau de Bord</h2>
    <p>Accédez rapidement à vos statistiques et actions principales.</p>
  </div>

  <!-- Statistiques -->
  <div class="dashboard-stats">
    <div class="stat-card total">
      <i class="fas fa-folder-open icon"></i>
      <h3>Total des demandes</h3>
      <p class="stat-value">{{ totalDemandes }}</p>
    </div>
    <div class="stat-card pending">
      <i class="fas fa-hourglass-half icon"></i>
      <h3>En attente</h3>
      <p class="stat-value">{{ demandesEnAttente }}</p>
    </div>
    <div class="stat-card approved">
      <i class="fas fa-check-circle icon"></i>
      <h3>Approuvées</h3>
      <p class="stat-value">{{ demandesApprouvees }}</p>
    </div>
    <div class="stat-card rejected">
      <i class="fas fa-times-circle icon"></i>
      <h3>Rejetées</h3>
      <p class="stat-value">{{ demandesRejetees }}</p>
    </div>
  </div>

  <!-- Actions -->
  <div class="dashboard-actions">
    <button class="btn primary" routerLink="/demandes/new">
      <i class="fas fa-plus-circle"></i> Nouvelle Demande
    </button>
    <button class="btn secondary" routerLink="/demandes">
      <i class="fas fa-list"></i> Voir toutes mes demandes
    </button>
  </div>

  <h3 class="section-title"><i class="fas fa-history"></i> Vos dernières demandes</h3>

  <!-- Recherche -->
  <div class="search-container">
    <i class="fas fa-search search-icon"></i>
    <input type="text" [(ngModel)]="searchTerm" (input)="applyFilter()" placeholder="Rechercher par type, montant, statut ou date...">
  </div>

  <!-- Tableau -->
  <div class="table-container">
    <table class="data-table">
      <thead>
        <tr>
          <th>Type</th>
          <th>Montant</th>
          <th>Statut</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="lastDemandes.length === 0 && !errorMessage">
          <td colspan="5">Aucune demande récente à afficher.</td>
        </tr>
        <tr *ngFor="let demande of lastDemandes">
          <td>{{ demande.type }}</td>
          <td>{{ demande.montant_total | currency:'Ariary':'symbol':'1.2-2':'fr' }}</td>
          <td>
            <span [ngClass]="{
              'status-badge': true,
              'status-pending': demande.status === 'En attente',
              'status-approved': demande.status === 'Approuvée',
              'status-rejected': demande.status === 'Rejetée'
            }">
              {{ demande.status }}
            </span>
          </td>
          <td>{{ demande.date | date: 'dd-MM-yyyy' }}</td>
          <td>
            <button class="btn btn-sm secondary" [routerLink]="['/demandes', demande.id]">
              <i class="fas fa-eye"></i> Voir
            </button>
          </td>
        </tr>
        <tr *ngIf="errorMessage">
          <td colspan="5" class="text-center text-danger">Erreur : {{ errorMessage }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
